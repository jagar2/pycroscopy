

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>pycroscopy.analysis.be_loop_model &mdash; pycroscopy 0.56.01 documentation</title>
  

  
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  

  
    <link rel="stylesheet" href="../_static/gallery.css" type="text/css" />
  

  
        <link rel="index" title="Index"
              href="../genindex.html"/>
        <link rel="search" title="Search" href="../search.html"/>
    <link rel="top" title="pycroscopy 0.56.01 documentation" href="../index.html"/> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> pycroscopy
          

          
          </a>

          
            
            
              <div class="version">
                0.56
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../Data_Format.html">Pycroscopy Data and File Format</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pycroscopy.html">pycroscopy package</a></li>
<li class="toctree-l1"><a class="reference internal" href="../auto_examples/index.html">Pycroscopy Gallery</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">pycroscopy</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
      <li>pycroscopy.analysis.be_loop_model</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/gen_modules/pycroscopy.analysis.be_loop_model.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="module-pycroscopy.analysis.be_loop_model">
<span id="pycroscopy-analysis-be-loop-model"></span><h1>pycroscopy.analysis.be_loop_model<a class="headerlink" href="#module-pycroscopy.analysis.be_loop_model" title="Permalink to this headline">¶</a></h1>
<p>Created on Thu Aug 25 11:48:53 2016</p>
<p>&#64;author: Suhas Somnath, Chris R. Smith, Rama K. Vasudevan</p>
<div class="section" id="classes">
<h2>Classes<a class="headerlink" href="#classes" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="pycroscopy.analysis.be_loop_model.BELoopModel">
<em class="property">class </em><code class="descname">BELoopModel</code><span class="sig-paren">(</span><em>h5_main, variables=['DC_Offset'], parallel=True</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pycroscopy/analysis/be_loop_model.html#BELoopModel"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pycroscopy.analysis.be_loop_model.BELoopModel" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="pycroscopy.analysis.model.html#pycroscopy.analysis.model.Model" title="pycroscopy.analysis.model.Model"><code class="xref py py-class docutils literal"><span class="pre">pycroscopy.analysis.model.Model</span></code></a></p>
<p>Analysis of Band excitation loops using functional fits</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>h5_main</strong> (<em>h5py.Dataset instance</em>) – The dataset over which the analysis will be performed. This dataset should be linked to the spectroscopic
indices and values, and position indices and values datasets.</li>
<li><strong>variables</strong> (<em>list</em><em>(</em><em>string</em><em>)</em><em>, </em><em>Default</em><em> [</em><em>'Frequency'</em><em>]</em>) – Lists of attributes that h5_main should possess so that it may be analyzed by Model.</li>
<li><strong>parallel</strong> (<em>bool</em><em>, </em><em>optional</em>) – Should the parallel implementation of the fitting be used.  Default True.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">None</p>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="pycroscopy.analysis.be_loop_model.BELoopModel._create_fit_dataset">
<code class="descname">_create_fit_dataset</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pycroscopy/analysis/be_loop_model.html#BELoopModel._create_fit_dataset"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pycroscopy.analysis.be_loop_model.BELoopModel._create_fit_dataset" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates the HDF5 Fit dataset and links the it to the ancillary datasets.</p>
</dd></dl>

<dl class="method">
<dt id="pycroscopy.analysis.be_loop_model.BELoopModel._create_guess_datasets">
<code class="descname">_create_guess_datasets</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pycroscopy/analysis/be_loop_model.html#BELoopModel._create_guess_datasets"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pycroscopy.analysis.be_loop_model.BELoopModel._create_guess_datasets" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates the HDF5 Guess dataset and links the it to the ancillary datasets.</p>
</dd></dl>

<dl class="method">
<dt id="pycroscopy.analysis.be_loop_model.BELoopModel._create_projection_datasets">
<code class="descname">_create_projection_datasets</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pycroscopy/analysis/be_loop_model.html#BELoopModel._create_projection_datasets"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pycroscopy.analysis.be_loop_model.BELoopModel._create_projection_datasets" title="Permalink to this definition">¶</a></dt>
<dd><p>Setup the Loop_Fit Group and the loop projection datasets</p>
</dd></dl>

<dl class="method">
<dt id="pycroscopy.analysis.be_loop_model.BELoopModel._get_data_chunk">
<code class="descname">_get_data_chunk</code><span class="sig-paren">(</span><em>verbose=False</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pycroscopy/analysis/be_loop_model.html#BELoopModel._get_data_chunk"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pycroscopy.analysis.be_loop_model.BELoopModel._get_data_chunk" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the next chunk of raw data for doing the loop projections.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>verbose</strong> (<em>Boolean</em>) – Whether or not to print debugging statements</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pycroscopy.analysis.be_loop_model.BELoopModel._get_dc_offset">
<code class="descname">_get_dc_offset</code><span class="sig-paren">(</span><em>verbose=False</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pycroscopy/analysis/be_loop_model.html#BELoopModel._get_dc_offset"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pycroscopy.analysis.be_loop_model.BELoopModel._get_dc_offset" title="Permalink to this definition">¶</a></dt>
<dd><p>Gets the DC offset for the current FORC step</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>verbose</strong> (<em>boolean</em><em> (</em><em>optional</em><em>)</em>) – Whether or not to print debugging statements</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><strong>dc_vec</strong> – DC offsets for the current FORC step</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">1D float numpy array</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pycroscopy.analysis.be_loop_model.BELoopModel._get_guess_chunk">
<code class="descname">_get_guess_chunk</code><span class="sig-paren">(</span><em>verbose=False</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pycroscopy/analysis/be_loop_model.html#BELoopModel._get_guess_chunk"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pycroscopy.analysis.be_loop_model.BELoopModel._get_guess_chunk" title="Permalink to this definition">¶</a></dt>
<dd><p>Read the next chunk of the Guess to use for fitting</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>verbose</strong> (<em>Boolean</em><em> (</em><em>optional</em><em>)</em>) – Whether or not to print debugging statements</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pycroscopy.analysis.be_loop_model.BELoopModel._get_sho_chunk_sizes">
<code class="descname">_get_sho_chunk_sizes</code><span class="sig-paren">(</span><em>max_mem_mb</em>, <em>verbose=False</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pycroscopy/analysis/be_loop_model.html#BELoopModel._get_sho_chunk_sizes"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pycroscopy.analysis.be_loop_model.BELoopModel._get_sho_chunk_sizes" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the largest number of positions that can be read into memory for a single FORC cycle</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>max_mem_mb</strong> (<em>unsigned int</em>) – Maximum allowable memory in megabytes</li>
<li><strong>verbose</strong> (<em>Boolean</em><em> (</em><em>Optional. Default is False</em><em>)</em>) – Whether or not to print debugging statements</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><ul class="simple">
<li><strong>max_pos</strong> (<em>unsigned int</em>) – largest number of positions that can be read into memory for a single FORC cycle</li>
<li><strong>sho_spec_inds_per_forc</strong> (<em>unsigned int</em>) – Number of indices in the SHO spectroscopic table that will be used per read</li>
<li><strong>metrics_spec_inds_per_forc</strong> (<em>unsigned int</em>) – Number of indices in the Loop metrics spectroscopic table that will be used per read</li>
</ul>
</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="staticmethod">
<dt id="pycroscopy.analysis.be_loop_model.BELoopModel._guess_loops">
<em class="property">static </em><code class="descname">_guess_loops</code><span class="sig-paren">(</span><em>vdc_vec</em>, <em>projected_loops_2d</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pycroscopy/analysis/be_loop_model.html#BELoopModel._guess_loops"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pycroscopy.analysis.be_loop_model.BELoopModel._guess_loops" title="Permalink to this definition">¶</a></dt>
<dd><p>Provides loop parameter guesses for a given set of loops</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>vdc_vec</strong> (<em>1D numpy float numpy array</em>) – DC voltage offsets for the loops</li>
<li><strong>projected_loops_2d</strong> (<em>2D numpy float array</em>) – Projected loops arranged as [instance or position x dc voltage steps]</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>guess_parms</strong> – Loop parameter guesses for the provided projected loops</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">1D compound numpy array</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pycroscopy.analysis.be_loop_model.BELoopModel._is_legal">
<code class="descname">_is_legal</code><span class="sig-paren">(</span><em>h5_main, variables=['DC_Offset']</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pycroscopy/analysis/be_loop_model.html#BELoopModel._is_legal"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pycroscopy.analysis.be_loop_model.BELoopModel._is_legal" title="Permalink to this definition">¶</a></dt>
<dd><p>Checks whether or not the provided object can be analyzed by this class.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>h5_main</strong> (<em>h5py.Dataset instance</em>) – The dataset containing the SHO Fit (not necessarily the dataset directly resulting from SHO fit)
over which the loop projection, guess, and fit will be performed.</li>
<li><strong>variables</strong> (<em>list</em><em>(</em><em>string</em><em>)</em>) – The dimensions needed to be present in the attributes of h5_main to analyze the data with Model.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>legal</strong> – Whether or not this dataset satisfies the necessary conditions for analysis</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">Boolean</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="staticmethod">
<dt id="pycroscopy.analysis.be_loop_model.BELoopModel._project_loop_batch">
<em class="property">static </em><code class="descname">_project_loop_batch</code><span class="sig-paren">(</span><em>dc_offset</em>, <em>sho_mat</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pycroscopy/analysis/be_loop_model.html#BELoopModel._project_loop_batch"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pycroscopy.analysis.be_loop_model.BELoopModel._project_loop_batch" title="Permalink to this definition">¶</a></dt>
<dd><p>This function projects loops given a matrix of the amplitude and phase.
These matrices (and the Vdc vector) must have a single cycle’s worth of
points on the second dimension</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>dc_offset</strong> (<em>1D list</em><em> or </em><em>numpy array</em>) – DC voltages. vector of length N</li>
<li><strong>sho_mat</strong> (<em>2D compound numpy array of type - sho32</em>) – SHO response matrix of size MxN - [pixel, dc voltage]</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><p><strong>results</strong> – Results from projecting the provided matrices with following components</p>
<dl class="docutils">
<dt>projected_loop_mat <span class="classifier-delimiter">:</span> <span class="classifier">MxN numpy array</span></dt>
<dd><p class="first last">Array of Projected loops</p>
</dd>
<dt>ancillary_mat <span class="classifier-delimiter">:</span> <span class="classifier">M, compound numpy array</span></dt>
<dd><p class="first">This matrix contains the ancillary information extracted when projecting the loop.
It contains the following components per loop:</p>
<blockquote class="last">
<div><p>’Area’ : geometric area of the loop</p>
<p>’Centroid x’: x positions of centroids for each projected loop</p>
<p>’Centroid y’: y positions of centroids for each projected loop</p>
<p>’Rotation Angle’: Angle by which loop was rotated [rad]</p>
<p>’Offset’: Offset removed from loop</p>
</div></blockquote>
</dd>
</dl>
</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">tuple</p>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This is the function that can be made parallel if need be.
However, it is fast enough as is</p>
</div>
</dd></dl>

<dl class="method">
<dt id="pycroscopy.analysis.be_loop_model.BELoopModel._project_loops">
<code class="descname">_project_loops</code><span class="sig-paren">(</span><em>verbose=False</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pycroscopy/analysis/be_loop_model.html#BELoopModel._project_loops"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pycroscopy.analysis.be_loop_model.BELoopModel._project_loops" title="Permalink to this definition">¶</a></dt>
<dd><p>Do the projection of the SHO fit
:param verbose: Whether or not to print debugging statements
:type verbose: Boolean</p>
</dd></dl>

<dl class="method">
<dt id="pycroscopy.analysis.be_loop_model.BELoopModel._reformat_results">
<code class="descname">_reformat_results</code><span class="sig-paren">(</span><em>results</em>, <em>strategy='BE_LOOP'</em>, <em>verbose=False</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pycroscopy/analysis/be_loop_model.html#BELoopModel._reformat_results"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pycroscopy.analysis.be_loop_model.BELoopModel._reformat_results" title="Permalink to this definition">¶</a></dt>
<dd><p>Reformat loop fit results to target compound dataset</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>results</strong> (<em>list</em>) – list of loop fit / guess results objects</li>
<li><strong>strategy</strong> (<em>string / unicode</em><em> (</em><em>optional</em><em>)</em>) – Name of the computational strategy</li>
<li><strong>verbose</strong> (<em>Boolean</em><em> (</em><em>optional</em><em>)</em>) – Whether or not to print debugging statements</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>temp</strong> – An array of the loop parameters in the target compound datatype</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">1D compound array</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pycroscopy.analysis.be_loop_model.BELoopModel._reshape_projected_loops_for_h5">
<code class="descname">_reshape_projected_loops_for_h5</code><span class="sig-paren">(</span><em>projected_loops_2d</em>, <em>order_dc_offset_reverse</em>, <em>nd_mat_shape_dc_first</em>, <em>verbose=False</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pycroscopy/analysis/be_loop_model.html#BELoopModel._reshape_projected_loops_for_h5"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pycroscopy.analysis.be_loop_model.BELoopModel._reshape_projected_loops_for_h5" title="Permalink to this definition">¶</a></dt>
<dd><p>Reshapes the 2D projected loops to the format such that they can be written to the h5 file</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>projected_loops_2d</strong> (<em>2D numpy float array</em>) – Projected loops arranged as [instance or position x dc voltage steps]</li>
<li><strong>order_dc_offset_reverse</strong> (<em>tuple of unsigned ints</em>) – Order in which the N dimensional data should be transposed to return it to the format used in h5 files</li>
<li><strong>nd_mat_shape_dc_first</strong> (<em>1D numpy unsigned int array</em>) – Shape of the N dimensional array that the loops_2d can be turned into.
We use the order_dc_offset_reverse after this reshape</li>
<li><strong>verbose</strong> (<em>Boolean</em><em> (</em><em>Optional. Default is False</em><em>)</em>) – Whether or not to print debugging statements</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>proj_loops_2d</strong> – Projected loops reshaped to the original chronological order in which the data was acquired</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">2D numpy float array</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pycroscopy.analysis.be_loop_model.BELoopModel._reshape_results_for_h5">
<code class="descname">_reshape_results_for_h5</code><span class="sig-paren">(</span><em>raw_results</em>, <em>nd_mat_shape_dc_first</em>, <em>verbose=False</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pycroscopy/analysis/be_loop_model.html#BELoopModel._reshape_results_for_h5"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pycroscopy.analysis.be_loop_model.BELoopModel._reshape_results_for_h5" title="Permalink to this definition">¶</a></dt>
<dd><p>Reshapes the 1D loop metrics to the format such that they can be written to the h5 file</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>raw_results</strong> (<em>2D numpy float array</em>) – loop metrics arranged as [instance or position x metrics]</li>
<li><strong>nd_mat_shape_dc_first</strong> (<em>1D numpy unsigned int array</em>) – Shape of the N dimensional array that the raw_results can be turned into.
We use the order_dc_offset_reverse after this reshape</li>
<li><strong>verbose</strong> (<em>Boolean</em><em> (</em><em>Optional. Default is False</em><em>)</em>) – Whether or not to print debugging statements</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>metrics_2d</strong> – Loop metrics reshaped to the original chronological order in which the data was acquired</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">2D numpy float array</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pycroscopy.analysis.be_loop_model.BELoopModel._reshape_sho_matrix">
<code class="descname">_reshape_sho_matrix</code><span class="sig-paren">(</span><em>raw_2d</em>, <em>verbose=False</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pycroscopy/analysis/be_loop_model.html#BELoopModel._reshape_sho_matrix"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pycroscopy.analysis.be_loop_model.BELoopModel._reshape_sho_matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Reshapes the raw 2D SHO matrix (as read from the file) to 2D array
arranged as [instance x points for a single loop]</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>raw_2d</strong> (<em>2D compound numpy array</em>) – Raw SHO fitted data arranged as [position, data for a single FORC cycle]</li>
<li><strong>verbose</strong> (<em>Boolean</em><em> (</em><em>Optional. Default is False</em><em>)</em>) – Whether or not to print debugging statements</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><ul class="simple">
<li><strong>loops_2d</strong> (<em>2D numpy compound array</em>) – SHO fitted data arranged as [instance or position x dc voltage steps]</li>
<li><strong>order_dc_offset_reverse</strong> (<em>tuple</em>) – Order in which the N dimensional data should be transposed to return it to the same format
as the input data of this function</li>
<li><strong>nd_mat_shape_dc_first</strong> (<em>1D numpy unsigned int array</em>) – Shape of the N dimensional array that the loops_2d can be turned into.
Use the order_dc_offset_reverse after this reshape</li>
</ul>
</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pycroscopy.analysis.be_loop_model.BELoopModel._set_guess">
<code class="descname">_set_guess</code><span class="sig-paren">(</span><em>h5_guess</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pycroscopy/analysis/be_loop_model.html#BELoopModel._set_guess"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pycroscopy.analysis.be_loop_model.BELoopModel._set_guess" title="Permalink to this definition">¶</a></dt>
<dd><p>Setup to run the fit on an existing guess dataset.  Sets the attributes
normally defined during do_guess.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>h5_guess</strong> (<em>h5py.Dataset</em>) – Dataset object containing the guesses</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pycroscopy.analysis.be_loop_model.BELoopModel.do_fit">
<code class="descname">do_fit</code><span class="sig-paren">(</span><em>processors=None</em>, <em>max_mem=None</em>, <em>solver_type='least_squares'</em>, <em>solver_options={'jac': '2-point'}</em>, <em>obj_func={'class': 'BE_Fit_Methods'</em>, <em>'obj_func': 'BE_LOOP'</em>, <em>'xvals': array([]</em>, <em>dtype=float64)}</em>, <em>get_loop_parameters=True</em>, <em>h5_guess=None</em>, <em>verbose=False</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pycroscopy/analysis/be_loop_model.html#BELoopModel.do_fit"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pycroscopy.analysis.be_loop_model.BELoopModel.do_fit" title="Permalink to this definition">¶</a></dt>
<dd><p>Fit the loops</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>processors</strong> (<em>uint</em><em>, </em><em>optional</em>) – Number of processors to use for computing. Currently this is a serial operation
Default None, output of psutil.cpu_count - 2 is used</li>
<li><strong>max_mem</strong> (<em>uint</em><em>, </em><em>optional</em>) – Memory in MB to use for computation
Default None, available memory from psutil.virtual_memory is used</li>
<li><strong>solver_type</strong> (<em>str</em>) – Which solver from scipy.optimize should be used to fit the loops</li>
<li><strong>solver_options</strong> (<em>dict of str</em>) – Parameters to be passed to the solver defined by <cite>solver_type</cite></li>
<li><strong>obj_func</strong> (<em>dict of str</em>) – Dictionary defining the class and method for the loop residual function as well
as the parameters to be passed</li>
<li><strong>get_loop_parameters</strong> (<em>bool</em><em>, </em><em>optional</em>) – Should the physical loop parameters be calculated after the guess is done
Default True</li>
<li><strong>h5_guess</strong> (<em>h5py.Dataset</em>) – Existing guess to use as input to fit.
Default None</li>
<li><strong>verbose</strong> (<em>Boolean</em>) – Whether or not to print debugging statements</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>results</strong> – List of the results returned by the solver</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">list</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pycroscopy.analysis.be_loop_model.BELoopModel.do_guess">
<code class="descname">do_guess</code><span class="sig-paren">(</span><em>max_mem=None</em>, <em>processors=None</em>, <em>get_loop_parameters=True</em>, <em>verbose=False</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pycroscopy/analysis/be_loop_model.html#BELoopModel.do_guess"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pycroscopy.analysis.be_loop_model.BELoopModel.do_guess" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the loop projections and the initial guess for the loop parameters.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>processors</strong> (<em>uint</em><em>, </em><em>optional</em>) – Number of processors to use for computing. Currently this is a serial operation and this attribute is
ignored.
Default None, output of psutil.cpu_count - 2 is used</li>
<li><strong>max_mem</strong> (<em>uint</em><em>, </em><em>optional</em>) – Memory in MB to use for computation
Default None, available memory from psutil.virtual_memory is used</li>
<li><strong>get_loop_parameters</strong> (<em>bool</em><em>, </em><em>optional</em>) – Should the physical loop parameters be calculated after the guess is done
Default True</li>
<li><strong>verbose</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether or not to print debug statements
Default False</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>h5_guess</strong> – h5py dataset containing the guess parameters</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">h5py.Dataset object</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="staticmethod">
<dt id="pycroscopy.analysis.be_loop_model.BELoopModel.extract_loop_parameters">
<em class="property">static </em><code class="descname">extract_loop_parameters</code><span class="sig-paren">(</span><em>h5_loop_fit</em>, <em>nuc_threshold=0.03</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pycroscopy/analysis/be_loop_model.html#BELoopModel.extract_loop_parameters"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pycroscopy.analysis.be_loop_model.BELoopModel.extract_loop_parameters" title="Permalink to this definition">¶</a></dt>
<dd><p>Method to extract a set of physical loop parameters from a dataset of fit parameters</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>h5_loop_fit</strong> (<em>h5py.Dataset</em>) – Dataset of loop fit parameters</li>
<li><strong>nuc_threshold</strong> (<em>float</em>) – Nucleation threshold to use in calculation physical parameters</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>h5_loop_parm</strong> – Dataset of physical parameters</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">h5py.Dataset</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="staticmethod">
<dt id="pycroscopy.analysis.be_loop_model.BELoopModel.shift_vdc">
<em class="property">static </em><code class="descname">shift_vdc</code><span class="sig-paren">(</span><em>vdc_vec</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pycroscopy/analysis/be_loop_model.html#BELoopModel.shift_vdc"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pycroscopy.analysis.be_loop_model.BELoopModel.shift_vdc" title="Permalink to this definition">¶</a></dt>
<dd><p>Rolls the Vdc vector by a quarter cycle</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>vdc_vec</strong> (<em>1D numpy array</em>) – DC offset vector</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><ul class="simple">
<li><strong>shift_ind</strong> (<em>int</em>) – Number of indices by which the vector was rolled</li>
<li><strong>vdc_shifted</strong> (<em>1D numpy array</em>) – Vdc vector rolled by a quarter cycle</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="pycroscopy.analysis.be_loop_model.LoopOptimize">
<em class="property">class </em><code class="descname">LoopOptimize</code><span class="sig-paren">(</span><em>data=array([]</em>, <em>dtype=float64)</em>, <em>guess=array([]</em>, <em>dtype=float64)</em>, <em>parallel=True</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pycroscopy/analysis/be_loop_model.html#LoopOptimize"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pycroscopy.analysis.be_loop_model.LoopOptimize" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="pycroscopy.analysis.optimize.html#pycroscopy.analysis.optimize.Optimize" title="pycroscopy.analysis.optimize.Optimize"><code class="xref py py-class docutils literal"><span class="pre">pycroscopy.analysis.optimize.Optimize</span></code></a></p>
<p>Subclass of Optimize with BE Loop specific changes</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>data</strong> – </td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="class">
<dt>
<em class="property">class </em><code class="descname">BELoopModel</code><span class="sig-paren">(</span><em>h5_main, variables=['DC_Offset'], parallel=True</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pycroscopy/analysis/be_loop_model.html#BELoopModel"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Bases: <a class="reference internal" href="pycroscopy.analysis.model.html#pycroscopy.analysis.model.Model" title="pycroscopy.analysis.model.Model"><code class="xref py py-class docutils literal"><span class="pre">pycroscopy.analysis.model.Model</span></code></a></p>
<p>Analysis of Band excitation loops using functional fits</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>h5_main</strong> (<em>h5py.Dataset instance</em>) – The dataset over which the analysis will be performed. This dataset should be linked to the spectroscopic
indices and values, and position indices and values datasets.</li>
<li><strong>variables</strong> (<em>list</em><em>(</em><em>string</em><em>)</em><em>, </em><em>Default</em><em> [</em><em>'Frequency'</em><em>]</em>) – Lists of attributes that h5_main should possess so that it may be analyzed by Model.</li>
<li><strong>parallel</strong> (<em>bool</em><em>, </em><em>optional</em>) – Should the parallel implementation of the fitting be used.  Default True.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">None</p>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt>
<code class="descname">_create_fit_dataset</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pycroscopy/analysis/be_loop_model.html#BELoopModel._create_fit_dataset"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Creates the HDF5 Fit dataset and links the it to the ancillary datasets.</p>
</dd></dl>

<dl class="method">
<dt>
<code class="descname">_create_guess_datasets</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pycroscopy/analysis/be_loop_model.html#BELoopModel._create_guess_datasets"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Creates the HDF5 Guess dataset and links the it to the ancillary datasets.</p>
</dd></dl>

<dl class="method">
<dt>
<code class="descname">_create_projection_datasets</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pycroscopy/analysis/be_loop_model.html#BELoopModel._create_projection_datasets"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Setup the Loop_Fit Group and the loop projection datasets</p>
</dd></dl>

<dl class="method">
<dt>
<code class="descname">_get_data_chunk</code><span class="sig-paren">(</span><em>verbose=False</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pycroscopy/analysis/be_loop_model.html#BELoopModel._get_data_chunk"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Get the next chunk of raw data for doing the loop projections.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>verbose</strong> (<em>Boolean</em>) – Whether or not to print debugging statements</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt>
<code class="descname">_get_dc_offset</code><span class="sig-paren">(</span><em>verbose=False</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pycroscopy/analysis/be_loop_model.html#BELoopModel._get_dc_offset"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Gets the DC offset for the current FORC step</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>verbose</strong> (<em>boolean</em><em> (</em><em>optional</em><em>)</em>) – Whether or not to print debugging statements</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><strong>dc_vec</strong> – DC offsets for the current FORC step</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">1D float numpy array</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt>
<code class="descname">_get_guess_chunk</code><span class="sig-paren">(</span><em>verbose=False</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pycroscopy/analysis/be_loop_model.html#BELoopModel._get_guess_chunk"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Read the next chunk of the Guess to use for fitting</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>verbose</strong> (<em>Boolean</em><em> (</em><em>optional</em><em>)</em>) – Whether or not to print debugging statements</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt>
<code class="descname">_get_sho_chunk_sizes</code><span class="sig-paren">(</span><em>max_mem_mb</em>, <em>verbose=False</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pycroscopy/analysis/be_loop_model.html#BELoopModel._get_sho_chunk_sizes"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Calculates the largest number of positions that can be read into memory for a single FORC cycle</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>max_mem_mb</strong> (<em>unsigned int</em>) – Maximum allowable memory in megabytes</li>
<li><strong>verbose</strong> (<em>Boolean</em><em> (</em><em>Optional. Default is False</em><em>)</em>) – Whether or not to print debugging statements</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><ul class="simple">
<li><strong>max_pos</strong> (<em>unsigned int</em>) – largest number of positions that can be read into memory for a single FORC cycle</li>
<li><strong>sho_spec_inds_per_forc</strong> (<em>unsigned int</em>) – Number of indices in the SHO spectroscopic table that will be used per read</li>
<li><strong>metrics_spec_inds_per_forc</strong> (<em>unsigned int</em>) – Number of indices in the Loop metrics spectroscopic table that will be used per read</li>
</ul>
</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="staticmethod">
<dt>
<em class="property">static </em><code class="descname">_guess_loops</code><span class="sig-paren">(</span><em>vdc_vec</em>, <em>projected_loops_2d</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pycroscopy/analysis/be_loop_model.html#BELoopModel._guess_loops"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Provides loop parameter guesses for a given set of loops</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>vdc_vec</strong> (<em>1D numpy float numpy array</em>) – DC voltage offsets for the loops</li>
<li><strong>projected_loops_2d</strong> (<em>2D numpy float array</em>) – Projected loops arranged as [instance or position x dc voltage steps]</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>guess_parms</strong> – Loop parameter guesses for the provided projected loops</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">1D compound numpy array</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt>
<code class="descname">_is_legal</code><span class="sig-paren">(</span><em>h5_main, variables=['DC_Offset']</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pycroscopy/analysis/be_loop_model.html#BELoopModel._is_legal"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Checks whether or not the provided object can be analyzed by this class.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>h5_main</strong> (<em>h5py.Dataset instance</em>) – The dataset containing the SHO Fit (not necessarily the dataset directly resulting from SHO fit)
over which the loop projection, guess, and fit will be performed.</li>
<li><strong>variables</strong> (<em>list</em><em>(</em><em>string</em><em>)</em>) – The dimensions needed to be present in the attributes of h5_main to analyze the data with Model.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>legal</strong> – Whether or not this dataset satisfies the necessary conditions for analysis</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">Boolean</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="staticmethod">
<dt>
<em class="property">static </em><code class="descname">_project_loop_batch</code><span class="sig-paren">(</span><em>dc_offset</em>, <em>sho_mat</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pycroscopy/analysis/be_loop_model.html#BELoopModel._project_loop_batch"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>This function projects loops given a matrix of the amplitude and phase.
These matrices (and the Vdc vector) must have a single cycle’s worth of
points on the second dimension</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>dc_offset</strong> (<em>1D list</em><em> or </em><em>numpy array</em>) – DC voltages. vector of length N</li>
<li><strong>sho_mat</strong> (<em>2D compound numpy array of type - sho32</em>) – SHO response matrix of size MxN - [pixel, dc voltage]</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><p><strong>results</strong> – Results from projecting the provided matrices with following components</p>
<dl class="docutils">
<dt>projected_loop_mat <span class="classifier-delimiter">:</span> <span class="classifier">MxN numpy array</span></dt>
<dd><p class="first last">Array of Projected loops</p>
</dd>
<dt>ancillary_mat <span class="classifier-delimiter">:</span> <span class="classifier">M, compound numpy array</span></dt>
<dd><p class="first">This matrix contains the ancillary information extracted when projecting the loop.
It contains the following components per loop:</p>
<blockquote class="last">
<div><p>’Area’ : geometric area of the loop</p>
<p>’Centroid x’: x positions of centroids for each projected loop</p>
<p>’Centroid y’: y positions of centroids for each projected loop</p>
<p>’Rotation Angle’: Angle by which loop was rotated [rad]</p>
<p>’Offset’: Offset removed from loop</p>
</div></blockquote>
</dd>
</dl>
</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">tuple</p>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This is the function that can be made parallel if need be.
However, it is fast enough as is</p>
</div>
</dd></dl>

<dl class="method">
<dt>
<code class="descname">_project_loops</code><span class="sig-paren">(</span><em>verbose=False</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pycroscopy/analysis/be_loop_model.html#BELoopModel._project_loops"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Do the projection of the SHO fit
:param verbose: Whether or not to print debugging statements
:type verbose: Boolean</p>
</dd></dl>

<dl class="method">
<dt>
<code class="descname">_reformat_results</code><span class="sig-paren">(</span><em>results</em>, <em>strategy='BE_LOOP'</em>, <em>verbose=False</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pycroscopy/analysis/be_loop_model.html#BELoopModel._reformat_results"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Reformat loop fit results to target compound dataset</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>results</strong> (<em>list</em>) – list of loop fit / guess results objects</li>
<li><strong>strategy</strong> (<em>string / unicode</em><em> (</em><em>optional</em><em>)</em>) – Name of the computational strategy</li>
<li><strong>verbose</strong> (<em>Boolean</em><em> (</em><em>optional</em><em>)</em>) – Whether or not to print debugging statements</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>temp</strong> – An array of the loop parameters in the target compound datatype</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">1D compound array</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt>
<code class="descname">_reshape_projected_loops_for_h5</code><span class="sig-paren">(</span><em>projected_loops_2d</em>, <em>order_dc_offset_reverse</em>, <em>nd_mat_shape_dc_first</em>, <em>verbose=False</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pycroscopy/analysis/be_loop_model.html#BELoopModel._reshape_projected_loops_for_h5"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Reshapes the 2D projected loops to the format such that they can be written to the h5 file</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>projected_loops_2d</strong> (<em>2D numpy float array</em>) – Projected loops arranged as [instance or position x dc voltage steps]</li>
<li><strong>order_dc_offset_reverse</strong> (<em>tuple of unsigned ints</em>) – Order in which the N dimensional data should be transposed to return it to the format used in h5 files</li>
<li><strong>nd_mat_shape_dc_first</strong> (<em>1D numpy unsigned int array</em>) – Shape of the N dimensional array that the loops_2d can be turned into.
We use the order_dc_offset_reverse after this reshape</li>
<li><strong>verbose</strong> (<em>Boolean</em><em> (</em><em>Optional. Default is False</em><em>)</em>) – Whether or not to print debugging statements</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>proj_loops_2d</strong> – Projected loops reshaped to the original chronological order in which the data was acquired</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">2D numpy float array</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt>
<code class="descname">_reshape_results_for_h5</code><span class="sig-paren">(</span><em>raw_results</em>, <em>nd_mat_shape_dc_first</em>, <em>verbose=False</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pycroscopy/analysis/be_loop_model.html#BELoopModel._reshape_results_for_h5"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Reshapes the 1D loop metrics to the format such that they can be written to the h5 file</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>raw_results</strong> (<em>2D numpy float array</em>) – loop metrics arranged as [instance or position x metrics]</li>
<li><strong>nd_mat_shape_dc_first</strong> (<em>1D numpy unsigned int array</em>) – Shape of the N dimensional array that the raw_results can be turned into.
We use the order_dc_offset_reverse after this reshape</li>
<li><strong>verbose</strong> (<em>Boolean</em><em> (</em><em>Optional. Default is False</em><em>)</em>) – Whether or not to print debugging statements</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>metrics_2d</strong> – Loop metrics reshaped to the original chronological order in which the data was acquired</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">2D numpy float array</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt>
<code class="descname">_reshape_sho_matrix</code><span class="sig-paren">(</span><em>raw_2d</em>, <em>verbose=False</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pycroscopy/analysis/be_loop_model.html#BELoopModel._reshape_sho_matrix"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Reshapes the raw 2D SHO matrix (as read from the file) to 2D array
arranged as [instance x points for a single loop]</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>raw_2d</strong> (<em>2D compound numpy array</em>) – Raw SHO fitted data arranged as [position, data for a single FORC cycle]</li>
<li><strong>verbose</strong> (<em>Boolean</em><em> (</em><em>Optional. Default is False</em><em>)</em>) – Whether or not to print debugging statements</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><ul class="simple">
<li><strong>loops_2d</strong> (<em>2D numpy compound array</em>) – SHO fitted data arranged as [instance or position x dc voltage steps]</li>
<li><strong>order_dc_offset_reverse</strong> (<em>tuple</em>) – Order in which the N dimensional data should be transposed to return it to the same format
as the input data of this function</li>
<li><strong>nd_mat_shape_dc_first</strong> (<em>1D numpy unsigned int array</em>) – Shape of the N dimensional array that the loops_2d can be turned into.
Use the order_dc_offset_reverse after this reshape</li>
</ul>
</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt>
<code class="descname">_set_guess</code><span class="sig-paren">(</span><em>h5_guess</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pycroscopy/analysis/be_loop_model.html#BELoopModel._set_guess"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Setup to run the fit on an existing guess dataset.  Sets the attributes
normally defined during do_guess.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>h5_guess</strong> (<em>h5py.Dataset</em>) – Dataset object containing the guesses</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt>
<code class="descname">do_fit</code><span class="sig-paren">(</span><em>processors=None</em>, <em>max_mem=None</em>, <em>solver_type='least_squares'</em>, <em>solver_options={'jac': '2-point'}</em>, <em>obj_func={'class': 'BE_Fit_Methods'</em>, <em>'obj_func': 'BE_LOOP'</em>, <em>'xvals': array([]</em>, <em>dtype=float64)}</em>, <em>get_loop_parameters=True</em>, <em>h5_guess=None</em>, <em>verbose=False</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pycroscopy/analysis/be_loop_model.html#BELoopModel.do_fit"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Fit the loops</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>processors</strong> (<em>uint</em><em>, </em><em>optional</em>) – Number of processors to use for computing. Currently this is a serial operation
Default None, output of psutil.cpu_count - 2 is used</li>
<li><strong>max_mem</strong> (<em>uint</em><em>, </em><em>optional</em>) – Memory in MB to use for computation
Default None, available memory from psutil.virtual_memory is used</li>
<li><strong>solver_type</strong> (<em>str</em>) – Which solver from scipy.optimize should be used to fit the loops</li>
<li><strong>solver_options</strong> (<em>dict of str</em>) – Parameters to be passed to the solver defined by <cite>solver_type</cite></li>
<li><strong>obj_func</strong> (<em>dict of str</em>) – Dictionary defining the class and method for the loop residual function as well
as the parameters to be passed</li>
<li><strong>get_loop_parameters</strong> (<em>bool</em><em>, </em><em>optional</em>) – Should the physical loop parameters be calculated after the guess is done
Default True</li>
<li><strong>h5_guess</strong> (<em>h5py.Dataset</em>) – Existing guess to use as input to fit.
Default None</li>
<li><strong>verbose</strong> (<em>Boolean</em>) – Whether or not to print debugging statements</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>results</strong> – List of the results returned by the solver</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">list</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt>
<code class="descname">do_guess</code><span class="sig-paren">(</span><em>max_mem=None</em>, <em>processors=None</em>, <em>get_loop_parameters=True</em>, <em>verbose=False</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pycroscopy/analysis/be_loop_model.html#BELoopModel.do_guess"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Compute the loop projections and the initial guess for the loop parameters.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>processors</strong> (<em>uint</em><em>, </em><em>optional</em>) – Number of processors to use for computing. Currently this is a serial operation and this attribute is
ignored.
Default None, output of psutil.cpu_count - 2 is used</li>
<li><strong>max_mem</strong> (<em>uint</em><em>, </em><em>optional</em>) – Memory in MB to use for computation
Default None, available memory from psutil.virtual_memory is used</li>
<li><strong>get_loop_parameters</strong> (<em>bool</em><em>, </em><em>optional</em>) – Should the physical loop parameters be calculated after the guess is done
Default True</li>
<li><strong>verbose</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether or not to print debug statements
Default False</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>h5_guess</strong> – h5py dataset containing the guess parameters</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">h5py.Dataset object</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="staticmethod">
<dt>
<em class="property">static </em><code class="descname">extract_loop_parameters</code><span class="sig-paren">(</span><em>h5_loop_fit</em>, <em>nuc_threshold=0.03</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pycroscopy/analysis/be_loop_model.html#BELoopModel.extract_loop_parameters"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Method to extract a set of physical loop parameters from a dataset of fit parameters</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>h5_loop_fit</strong> (<em>h5py.Dataset</em>) – Dataset of loop fit parameters</li>
<li><strong>nuc_threshold</strong> (<em>float</em>) – Nucleation threshold to use in calculation physical parameters</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>h5_loop_parm</strong> – Dataset of physical parameters</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">h5py.Dataset</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="staticmethod">
<dt>
<em class="property">static </em><code class="descname">shift_vdc</code><span class="sig-paren">(</span><em>vdc_vec</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pycroscopy/analysis/be_loop_model.html#BELoopModel.shift_vdc"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Rolls the Vdc vector by a quarter cycle</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>vdc_vec</strong> (<em>1D numpy array</em>) – DC offset vector</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><ul class="simple">
<li><strong>shift_ind</strong> (<em>int</em>) – Number of indices by which the vector was rolled</li>
<li><strong>vdc_shifted</strong> (<em>1D numpy array</em>) – Vdc vector rolled by a quarter cycle</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt>
<em class="property">class </em><code class="descname">LoopOptimize</code><span class="sig-paren">(</span><em>data=array([]</em>, <em>dtype=float64)</em>, <em>guess=array([]</em>, <em>dtype=float64)</em>, <em>parallel=True</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pycroscopy/analysis/be_loop_model.html#LoopOptimize"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Bases: <a class="reference internal" href="pycroscopy.analysis.optimize.html#pycroscopy.analysis.optimize.Optimize" title="pycroscopy.analysis.optimize.Optimize"><code class="xref py py-class docutils literal"><span class="pre">pycroscopy.analysis.optimize.Optimize</span></code></a></p>
<p>Subclass of Optimize with BE Loop specific changes</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>data</strong> – </td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2016, Numan Laanait, Suhas Somnath, Chris Smith.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'0.56.01',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>